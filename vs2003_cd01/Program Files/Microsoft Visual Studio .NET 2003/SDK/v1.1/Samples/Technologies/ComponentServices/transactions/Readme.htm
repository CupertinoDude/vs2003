<?xml version="1.0" encoding="utf-8"?><root xmlns:dt="urn:schemas-microsoft-com:datatypes" xmlns:d2="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"><?xml-stylesheet type="text/xsl" href="..\..\..\readme.xsl"?><HTML><HEAD><TITLE>COM+ Transactions</TITLE><STYLE>
    .Title{FONT-FAMILY: Verdana;FONT-SIZE: large;COLOR: #808080}
    </STYLE><STYLE>
    .Heading{FONT-FAMILY: Verdana;FONT-SIZE: large}
    </STYLE><STYLE>
    .SectionBreak{FONT-SIZE: small;MARGIN-BOTTOM: 2em}
    </STYLE><STYLE>
    .SmallBreak{FONT-SIZE: small;MARGIN-BOTTOM: 1.5em}
    </STYLE><STYLE>
    .Text{FONT-FAMILY: Verdana;FONT-SIZE: x-small}
    </STYLE><STYLE>
    .FixedHeading{FONT-FAMILY: Verdana;FONT-SIZE: x-small}
    </STYLE><STYLE>
    .FixedText{MARGIN-LEFT: 3ex;FONT-FAMILY: Lucida Console;FONT-SIZE: x-small;FONT-WEIGHT: Bold}
    </STYLE><STYLE>
    .ListSansBullets {list-style-type: none;FONT-FAMILY: Verdana;FONT-SIZE: x-small}
    </STYLE></HEAD><BODY><table><tr><td><h2 class="Title">COM+ Transactions</h2></td><td valign="baseline" class="Text">
               
              
                  (Windows Forms Application)
                </td></tr></table><p class="Text">
    This document contains the release information for the .NET Framework COM+ Transactions sample. You will find the following sections below: 
    </p><ul class="Text"><li><a href="#_Sample_Overview">Overview</a></li><li><a href="#_Sample_Topics">Topics</a></li><li><a href="#_Location_of_Sample">Location</a></li><li><a href="#_Building_the_Sample">Building the sample</a></li><li><a href="#_Running_the_Sample">Running the sample</a></li><li><a href="#_Uninstalling_the_Sample">Uninstalling the sample</a></li><li><a href="#_sdkvars">Notes</a></li></ul><p class="SectionBreak" /><h4 class="Heading"><a name="_Sample_Overview" />
    Overview
    </h4><p class="Text"><p class="text">
This sample demonstrates some aspects of COM+ Transactions in a .NET Framework application. The sample retrieves a value from the database, 
then it allows the user to update the value. After the user specifies a new value and selects AutoCompletePost or Post the sample updates
the database. Then the sample checks to see if the value entered is permitted (it must be a number =&gt;0 and &lt;=10). If the value is
not permitted, the sample aborts the transaction and otherwise commits. Finally the sample shows what the new value in the database is.
</p></p><p class="SectionBreak" /><h4 class="Heading"><a name="_Sample_Topics" />
  Topics
  </h4><p class="Text">
  The following bullets briefly describe the technologies used by this sample.
  </p><ul class="Text"><li><b>ContextUtil - </b>The ContextUtil class is used to tell the system either to abort or complete the transaction.
</li><li><b>COM+ - </b>COM+ is the underlying system which automates the transactions in .NET.
</li><li><b>Transaction - </b>An transaction is a set of operations that belong together, they should either 
all be performed or all not be performed. Whenever one of the operations in the transaction fails, all prior operations should rollback to ensure 
there is no inconsistency.
</li><li><b>SetAbort - </b>Method in ContextUtil that can be called to manually abort the transaction.
</li><li><b>SetComplete - </b>Method in ContextUtil that can be called to manually commit the transaction.
</li><li><b>AutoCompleteAttribute - </b>Attribute that enables automatic transactions on a method.
</li><li><b>TransactionAttribute - </b>Attribute that enables transactions on a class.
</li><li><b>ServicedComponent - </b>Abstract class that implements the features to let a .NET class enrole in COM+.
</li></ul><p class="SectionBreak" /><h4 class="Heading"><a name="_Location_of_Sample" />
    Location
    </h4><p class="Text">
    This sample is located in the <a href="." title="Jump to Folder" target="_blank">Technologies\ComponentServices\Transactions</a> subdirectory of the .NET Framework SDK samples directory.
    </p><p class="FixedHeading">
    For Example:
      <p class="FixedText">
      C:\Program Files\Microsoft.NET\SDK\v1.1\Samples\Technologies\ComponentServices\Transactions</p></p><p class="SectionBreak" /><h4 class="Heading"><a name="_Building_the_Sample" />
    Building the Sample
    </h4><p class="Text">
    In order to properly build and run this sample, the following steps need to be performed.
    </p><p class="Text"> 
Type <b>BuildAll.bat</b> from the command line.      
<p class="FixedHeading">
  For Example:
  </p><p class="FixedText"> 
C:\Program Files\Microsoft.NET\SDK\v1.1\Samples\Technologies\ComponentServices\Transactions&gt;buildall.bat
</p></p><p class="Text">
You'll also need to setup the database yourself when building from Visual Studio 7.
<p class="FixedHeading">
  For Example:
  </p><p class="FixedText">
C:\Program Files\Microsoft.NET\SDK\v1.1\Samples\Technologies\ComponentServices\Transactions\CS&gt;osql -E -S (local)\NetSDK -i TxDB.sql
</p></p><p class="Text">
If you're building the sample from Visual Studio 7, you will need to install the TxDemoSvr.dll assembly to the Global Assembly Cache before running the sample.  Note: The gacutil.exe program is located in the <i>SDK\v1.1</i>\Bin directory.  
<p class="FixedHeading">
  For Example:
  </p><p class="FixedText">
C:\Program Files\Microsoft.NET\SDK\v1.1\Samples\Technologies\ComponentServices\Transactions\CS&gt;gacutil -i TxDemoSvr.dll
</p></p><p class="Text">
The sample builds a C# and VB version of the client application and COM+ component. Source code for each language is stored in subdirectories named \CS and \VB. The C# component has 'CS' appended to its name as viewed in the Component Services administrative tool, 'TxDemoServerCS.TxObject'. The VB version is named 'TxDemoServerVB.TxObject'. When working with the sample code, be sure to observe and/or modify the version of the COM+ component that corresponds to the client application you launch.
</p><p class="Text">
Review comments in the source code and build.bat files for more information on sample binary creation and registration steps.
</p><p class="SectionBreak" /><h4 class="Heading"><a name="_Running_the_Sample" />
    Running the Sample
    </h4><p class="Text">
    In order to run this sample, follow the instructions listed below.
    </p><span class="Text"><ul class="Text"><li>
NOTE: The COM+ .NET samples require Windows 2000 or higher in order to build and run.
</li></ul><ul class="Text"><li>
Build the Transactions sample code following the instructions above.
</li></ul><ul class="Text"><li>
Type <b>TxDemo.exe</b> from the command line.
<p class="FixedHeading">
  For Example:
  </p><p class="FixedText">
C:\Program Files\Microsoft.NET\SDK\v1.1\Samples\Technologies\ComponentServices\Transactions\CS&gt;txdemo.exe
</p></li></ul><ul class="Text"><li>
The current value is read from the database and displayed.
</li></ul><ul class="Text"><li>
Enter a number =&gt;0 and &lt;=10 in the 'New value' field. Click on the button named 'Post'.
</li></ul><ul class="Text"><li>
The message 'About to commit the transaction' should appear. Click on 'OK'. The 'Current value' field is now updated with the value you entered.
</li></ul><ul class="Text"><li>
Enter a number =&gt;0 or &lt;=10 in the 'New value' field. Click on the button named 'Post'.
</li></ul><ul class="Text"><li>
The message 'About to abort the transaction because the new value (&lt;yourvalue&gt;) is either &lt;0 or &gt;10.' should appear. Press OK, the 'Current value' field doesn't change.
This is because during the transaction the current value did change, but when the transaction was rolled back, the value was changed back to its original value. 
</li></ul><ul class="Text"><li>
Now try the same data with the 'AutoPost' button. You'll notice when the demo aborts the transaction it will throw an COMException. This is to notify the AutoComplete 
to do an abort.
</li></ul></span><p class="SectionBreak" /><h4 class="Heading"><a name="_Uninstalling_the_Sample" />			
			Uninstalling the Sample
		</h4><p class="Text">
			In order to uninstall this sample, follow the instructions listed below.
		</p><span class="Text"><ul class="Text"><li>
To uninstall this sample, run <b>buildall.bat -u.</b> or <b>build.bat -u.</b> The batch file will then call regsvcs and gacutil with the /u switch in order to remove the sample files from the COM+ catalog and Global Assembly Cache.
</li></ul></span><p class="SectionBreak" /><h4 class="Heading"><a name="_sdkvars" />
    Notes
    </h4><p class="Text">
    For the .Net Framework samples to function properly, your Path, Include, and Lib environment variables must be set correctly. 
    In many cases, the SDK install program updates these environment variables for you. However, if you installed the .Net Framework SDK 
    using Visual Studio .NET, or unselected "register environment variables" during setup, these environment variables will not be updated. 
    You can set the Path, Include and Lib environment variables by running SDKVars.bat, located in the <i>&lt;SDKRoot&gt;\Bin</i> directory. 
    SDKVars.bat must be executed in every command shell.
    </p></BODY></HTML></root>